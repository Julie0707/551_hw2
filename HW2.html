<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Geovanna Caballero, Fengqi Lin, Jiaqi Zhu">

<title>Stats551_HW2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="HW2_files/libs/clipboard/clipboard.min.js"></script>
<script src="HW2_files/libs/quarto-html/quarto.js"></script>
<script src="HW2_files/libs/quarto-html/popper.min.js"></script>
<script src="HW2_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="HW2_files/libs/quarto-html/anchor.min.js"></script>
<link href="HW2_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="HW2_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="HW2_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="HW2_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="HW2_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Stats551_HW2</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Geovanna Caballero, Fengqi Lin, Jiaqi Zhu </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<p>We contribute to this homework equally.</p>
<section id="problem-1" class="level2">
<h2 class="anchored" data-anchor-id="problem-1">Problem 1</h2>
<p>Assuming a coffee company is interested in how annual coffee consumption U relates to other variables for a specific person, we then might want to predict θ=U based on available data of X (age), Y (country), Z (attended a picnic or not), V (screen time), and W (passport photo). Let us denote that for each individual, we have data Di= {Di1=age, Di2=country, Di3=attended a picnic or not, Di4=screen time,Di5=passport photo}</p>
<p><strong>1. Bayesian coverage:</strong></p>
<p><strong>Inferential scenario:</strong> we start with a prior distribution for U based on previous data on coffee consumption in the population. Suppose that our belief is that younger people consume more coffee than older people, or that people from certain countries consume more coffee than others. The posterior probability of U is the prior updated by Bayes’ theorem based on the information of individual collected.</p>
<p><strong>Meaning of the probability:</strong> an interval [l(d), u(d)] based on data D=d, has 95% Bayesian coverage for θ if P(l(d)&lt;&lt;u(d)|D=d)=0.95. Having observed the data and calculated the conditional probability, the unknown θ is in the given interval with a probability of 95%.</p>
<p>This is useful when a coffee company tries to make marketing decisions for populations of different demographics. Market staff could tailor strategies based on the collected information of individual customers.</p>
<p><strong>2. Frequentist coverage:</strong></p>
<p><strong>Inferential scenario:</strong> a coffee company is interested in the daily coffee consumption habits of adults in a particular country. To estimate the average amount of coffee an adult drinks in a day, they conducted a survey by randomly selecting 1000 adults in that country and asking about how many cups of coffee on average they drink in a day. From the samples, they calculated an average coffee consumption of 2 cups per day with a standard deviation of 0.5 cups. Using this data, they calculated a 95% confidence interval for the true mean daily coffee consumption to be (1.969 cups, 2.031 cups).</p>
<p><strong>Meaning of the probability:</strong> a random interval [l(D), u(D)] has 95% frequentist coverage for θ (true mean daily coffee consumption) if, before the data are gathered, P(l(D)&lt;&lt;u(D)|)=0.95. If we are running a large number of unrelated (independent) experiments and create the interval [l(d), u(d)] for each of them, then we can expect that 95% of the intervals contain the correct parameter value.</p>
<p>For coffee companies interested in broad trends of coffee consumption without specific prior beliefs, this approach allows them to make generalizations about a population based on a sample.</p>
</section>
<section id="problem-2" class="level2">
<h2 class="anchored" data-anchor-id="problem-2">Problem 2</h2>
<ol type="a">
<li>Find the posterior distributions, means, variances and 95% quantile based confidence intervals for θA and θB.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qgamma</span>(<span class="fu">c</span>(<span class="fl">0.025</span>,.<span class="dv">975</span>), <span class="dv">237</span>, <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10.38924 13.40545</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qgamma</span>(<span class="fu">c</span>(<span class="fl">0.025</span>,.<span class="dv">975</span>), <span class="dv">125</span>, <span class="dv">14</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  7.432064 10.560308</code></pre>
</div>
</div>
<p><img src="p2_a.png" class="img-fluid"></p>
<ol start="2" type="a">
<li>Compute and plot the posterior expectation of θB under the prior θB ∼ gamma(12 × n0, n0), for each value of n0 ∈ {1, 2, . . . , 50}. Describe what sort of prior beliefs about θB would be necessary in order for the posterior expectation of θB to be close to that of θA.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">551</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>yB <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">11</span>, <span class="dv">10</span>, <span class="dv">9</span>, <span class="dv">9</span>, <span class="dv">8</span>, <span class="dv">7</span>, <span class="dv">10</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">7</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>n_B <span class="ot">&lt;-</span> <span class="fu">length</span>(yB)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>sum_yB <span class="ot">&lt;-</span> <span class="fu">sum</span>(yB)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to compute the posterior expectation</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>compute_posterior_mean <span class="ot">&lt;-</span> <span class="cf">function</span>(alpha_prior, beta_prior) {</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  alpha_posterior <span class="ot">&lt;-</span> alpha_prior <span class="sc">+</span> sum_yB</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  beta_posterior <span class="ot">&lt;-</span> beta_prior <span class="sc">+</span> n_B</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(alpha_posterior <span class="sc">/</span> beta_posterior)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute posterior expectation for each n0 belongs to {1, 2, ... 50}</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>n0_values <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>posterior_means <span class="ot">&lt;-</span> <span class="fu">sapply</span>(n0_values, <span class="cf">function</span>(n0) <span class="fu">compute_posterior_mean</span>(<span class="dv">12</span> <span class="sc">*</span> n0, n0))</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the results</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">n0 =</span> n0_values, <span class="at">posterior_mean =</span> posterior_means)</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> n0, <span class="at">y =</span> posterior_mean)) <span class="sc">+</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Posterior Expectation of θ_B for different n0 values"</span>) <span class="sc">+</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">11.85</span>) <span class="sc">+</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"n0"</span>) <span class="sc">+</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Posterior Expectation of θ_B"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HW2_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>From the plot, we can see that larger values of n0, which lead to larger values of shape and rate parameters of prior distribution of B, would be necessary in order for the posterior expectation of B to be close to that of A.</strong></p>
<ol start="3" type="a">
<li>Should knowledge about population A tell us anything about the population B? Discuss whether or not it makes sense to have p(θA, θb) = p(θA) × p(θB).</li>
</ol>
<p>Given that type B mice are related to type A mice, then it’s reasonable to believe that information about group A mice could tell us about group B mice. In the real world, two strains of mice might be biologically related to each other for some reason. For example, they may share certain traits or genetics that may affect tumor growth. Thus, the tumor count rates might be expected to be similar to some extent.</p>
<p>p( A, B)=p( A)*p( B) implies that the prior distribution for A and B are independent. Before observing any data, our beliefs of A would not influence the beliefs of B and vice versa.</p>
<p>If we have no reason to believe that the rates of tumorigenesis in strains A and B are related, then the assumption of independence is appropriate. Suppose that two groups of mice are from the same lab and even manipulated by the same technician. The assumption that the two priors are independent will not make sense. In addition, if the sample size n is large enough, we can get rid of the prior information.</p>
<ol start="4" type="a">
<li>Investigate the adequacy of the Poisson sampling model via posterior predictive checks and Monte Carlo technique for population A.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>yA <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">9</span>, <span class="dv">12</span>, <span class="dv">14</span>, <span class="dv">13</span>, <span class="dv">13</span>, <span class="dv">15</span>, <span class="dv">8</span>, <span class="dv">15</span>, <span class="dv">6</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters for the gamma prior for theta_A</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>alpha_prior <span class="ot">&lt;-</span> <span class="dv">120</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>beta_prior <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Update the parameters for the gamma posterior for theta_A using the conjugacy property of the Gamma-Poisson model</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>alpha_posterior <span class="ot">&lt;-</span> alpha_prior <span class="sc">+</span> <span class="fu">sum</span>(yA)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>beta_posterior <span class="ot">&lt;-</span> beta_prior <span class="sc">+</span> <span class="fu">length</span>(yA)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">551</span>)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample theta_A values from the posterior distribution</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>thetaA.mc <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="dv">10000</span>, <span class="at">shape =</span> alpha_posterior, <span class="at">rate =</span> beta_posterior)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co"># For each sampled theta_A, generate new data from a Poisson distribution</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>yA.mc <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rpois</span>(<span class="dv">10000</span> <span class="sc">*</span> <span class="fu">length</span>(yA), <span class="at">lambda =</span> <span class="fu">rep</span>(thetaA.mc, <span class="at">each =</span> <span class="fu">length</span>(yA))), <span class="at">ncol =</span> <span class="fu">length</span>(yA))</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the test statistic t(s) for each simulated dataset</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>t_s <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(yA.mc) <span class="sc">/</span> <span class="fu">apply</span>(yA.mc, <span class="dv">1</span>, sd)</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the test statistic for the observed data</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>t_observed <span class="ot">&lt;-</span> <span class="fu">mean</span>(yA) <span class="sc">/</span> <span class="fu">sd</span>(yA)</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot histogram of t_s values and add a vertical line for t_observed</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(t_s, <span class="at">breaks =</span> <span class="dv">50</span>, <span class="at">col =</span> <span class="st">"lightyellow"</span>, <span class="at">main =</span> <span class="st">"Posterior Predictive Distribution"</span>, <span class="at">xlab =</span> <span class="st">"t(s)"</span>)</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> t_observed, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> <span class="st">"Observed t"</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HW2_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(t_s <span class="sc">&gt;=</span> t_observed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3588</code></pre>
</div>
</div>
<p><strong>The t(yobs) lies within the central bulk of the histogram above. This suggests that the observed test statistic is consistent with those generated under the Poisson model, indicating that the Poisson sampling model is adequate. About 35.88% (out of 10,000 Monte Carlo samples) of the simulated test statistics are equal to or more extreme than the observed test statistic. This suggests that the Poisson sampling model for population A is reasonable.</strong></p>
<ol start="5" type="a">
<li>Repeat the above goodness of fit evaluation for the data in population B.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>yB <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">11</span>, <span class="dv">10</span>, <span class="dv">9</span>, <span class="dv">9</span>, <span class="dv">8</span>, <span class="dv">7</span>, <span class="dv">10</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">7</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters for the gamma prior for theta_B</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>alpha_prior <span class="ot">&lt;-</span> <span class="dv">12</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>beta_prior <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Update the parameters for the gamma posterior for theta_B using the conjugacy property of the Gamma-Poisson model</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>alpha_posterior <span class="ot">&lt;-</span> alpha_prior <span class="sc">+</span> <span class="fu">sum</span>(yB)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>beta_posterior <span class="ot">&lt;-</span> beta_prior <span class="sc">+</span> <span class="fu">length</span>(yB)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample theta_B values from the posterior distribution</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>thetaB.mc <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="dv">10000</span>, <span class="at">shape =</span> alpha_posterior, <span class="at">rate =</span> beta_posterior)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co"># For each sampled theta_B, generate new data from a Poisson distribution</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>yB.mc <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rpois</span>(<span class="dv">10000</span> <span class="sc">*</span> <span class="fu">length</span>(yB), <span class="at">lambda =</span> <span class="fu">rep</span>(thetaB.mc, <span class="at">each =</span> <span class="fu">length</span>(yB))), <span class="at">ncol =</span> <span class="fu">length</span>(yB))</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the test statistic t(s) for each simulated dataset</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>t_s <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(yB.mc) <span class="sc">/</span> <span class="fu">apply</span>(yB.mc, <span class="dv">1</span>, sd)</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the test statistic for the observed data</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>t_observed <span class="ot">&lt;-</span> <span class="fu">mean</span>(yB) <span class="sc">/</span> <span class="fu">sd</span>(yB)</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot histogram of t_s values and add a vertical line for t_observed</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(t_s, <span class="at">breaks =</span> <span class="dv">50</span>, <span class="at">col =</span> <span class="st">"lightyellow"</span>, <span class="at">main =</span> <span class="st">"Posterior Predictive Distribution"</span>, <span class="at">xlab =</span> <span class="st">"t(s)"</span>)</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> t_observed, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> <span class="st">"Observed t"</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HW2_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(t_s <span class="sc">&gt;=</span> t_observed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0051</code></pre>
</div>
</div>
<p>From the histogram, we observe that out of 10,000 Monte Carlo samples, only about 0.51% had values of t(y) that equaled or exceeded t(yobs). This indicates that the Poisson sampling model for population B is flawed.</p>
</section>
<section id="problem-3" class="level2">
<h2 class="anchored" data-anchor-id="problem-3">Problem 3</h2>
<ol type="a">
<li><p>Show that if y|θ is exponentially distributed with rate θ, then the gamma prior distribution is conjugate for inferences about θ given an i.i.d. sample of y values. <img src="p3_a.png" class="img-fluid"></p></li>
<li><p>The length of life of a light bulb manufactured by a certain process has an exponential distribution with unknown rate θ. Suppose the prior for θ is a gamma distribution with coefficient of variation 0.5. A random sample of light bulbs is to be tested and the life time of each obtained. If the coefficient of variation of the distribution of θ is to be reduced to 0.1, how many light bulbs need to be tested?</p></li>
<li><p>In part (b), if the coefficient of variation refers to φ := 1/θ, which is now endowed with an inverse-gamma prior, how would your answer be changed?</p></li>
<li><p>Suppose that y|θ is exponentially distributed with rate θ and θ is endowed with prior Gamma(α, β). Suppose we observe a data sample y ≥ 100 but do not observe its exact value. What is the posterior distribution of θ as a function of α and β? <img src="p3_d.png" class="img-fluid"></p></li>
<li><p>Suppose now that we are told y = 100, what is the posterior mean and variance of θ? Explain why the posterior variance is higher in part (d) even though more information has been observed.</p></li>
</ol>
<p><img src="p3_e.png" class="img-fluid"></p>
</section>
<section id="problem-4" class="level2">
<h2 class="anchored" data-anchor-id="problem-4">Problem 4</h2>
<p>A scientist using an apparatus of known standard deviation σ = 0.12 takes nine i.i.d. measurements of some quantity. The measurements are assumed to be normally distributed, with the stated standard deviation σ and unknown mean θ, where the scientist is willing to place a vague on θ (i.e., the variance of the prior distribution is very large). If the sample mean obtained is 17.653, obtain limits of an interval between which a tenth measurement will lie with 99% probability.</p>
<p><img src="p4.png" class="img-fluid" alt="Answer"> Since the variance of the prior distribution is very large, we assume it’s close to infinity. Based on this assumption, the interval between which a tenth measurement will lie with 99% probability is <strong>(17.3272, 17.9788)</strong></p>
</section>
<section id="problem-5" class="level2">
<h2 class="anchored" data-anchor-id="problem-5">Problem 5</h2>
<p>The files school1.dat, school2.dat, school3.dat contain data on the amount of time students from three high schools spent on studying or homework during an exam period. Analyze data from each of these schools separately, using the normal model with a conjugate prior distribution, in which {µ0 = 5, σ20 = 4, κ0 = 1, ν0 = 2}, and compute or approximate the following:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>mu0 <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>sigma2_0 <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>kappa0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>nu0 <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data sets file</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>school1 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">read.table</span>(<span class="st">"/Users/jiaqizhu/Downloads/stats551/hw/school1.dat"</span>)[,<span class="dv">1</span>])</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>school2 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">read.table</span>(<span class="st">"/Users/jiaqizhu/Downloads/stats551/hw/school2.dat"</span>)[,<span class="dv">1</span>])</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>school3 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">read.table</span>(<span class="st">"/Users/jiaqizhu/Downloads/stats551/hw/school3.dat"</span>)[,<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="a">
<li>posterior means and 95% confidence intervals for the mean θ and standard deviation σ from each school;</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># posteriors parameters</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>update_parameters <span class="ot">&lt;-</span> <span class="cf">function</span>(data, mu0, sigma2_0, kappa0, nu0) {</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(data)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  ybar <span class="ot">&lt;-</span> <span class="fu">mean</span>(data)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  s2 <span class="ot">&lt;-</span> <span class="fu">var</span>(data)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  kappa_n <span class="ot">&lt;-</span> kappa0 <span class="sc">+</span> n</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  mu_n <span class="ot">&lt;-</span> (kappa0 <span class="sc">*</span> mu0 <span class="sc">+</span> n <span class="sc">*</span> ybar) <span class="sc">/</span> kappa_n</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  nu_n <span class="ot">&lt;-</span> nu0 <span class="sc">+</span> n</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  sigma2_n <span class="ot">&lt;-</span> (nu0<span class="sc">*</span>sigma2_0 <span class="sc">+</span> (n<span class="dv">-1</span>)<span class="sc">*</span>s2 <span class="sc">+</span> kappa0<span class="sc">*</span>n<span class="sc">*</span>(ybar<span class="sc">-</span>mu0)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>kappa_n) <span class="sc">/</span> (nu_n)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">mu_n=</span>mu_n, <span class="at">sigma2_n=</span>sigma2_n, <span class="at">kappa_n=</span>kappa_n, <span class="at">nu_n=</span>nu_n)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>post_params1 <span class="ot">&lt;-</span> <span class="fu">update_parameters</span>(school1, mu0, sigma2_0, kappa0, nu0)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>post_params2 <span class="ot">&lt;-</span> <span class="fu">update_parameters</span>(school2, mu0, sigma2_0, kappa0, nu0)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>post_params3 <span class="ot">&lt;-</span> <span class="fu">update_parameters</span>(school3, mu0, sigma2_0, kappa0, nu0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># function to get posterior means and CI for the mean and standard deviation</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>get_post_stats <span class="ot">&lt;-</span> <span class="cf">function</span>(post_params){</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  s2_sampling <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">rgamma</span>(<span class="dv">10000</span>,<span class="at">shape =</span> post_params<span class="sc">$</span>nu_n <span class="sc">/</span> <span class="dv">2</span>, <span class="at">rate =</span> post_params<span class="sc">$</span>sigma2_n <span class="sc">*</span> (post_params<span class="sc">$</span>nu_n <span class="sc">/</span> <span class="dv">2</span>))</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  theta_sampling <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>, <span class="at">mean =</span> post_params<span class="sc">$</span>mu_n, <span class="at">sd =</span> <span class="fu">sqrt</span>(s2_sampling<span class="sc">/</span>post_params<span class="sc">$</span>kappa_n))</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_theta =</span> <span class="fu">mean</span>(theta_sampling),</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI_theta =</span> <span class="fu">quantile</span>(theta_sampling, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)),</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_sigma =</span> <span class="fu">mean</span>(<span class="fu">sqrt</span>(s2_sampling)),</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI_sigma =</span> <span class="fu">quantile</span>(<span class="fu">sqrt</span>(s2_sampling),<span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>school1_result <span class="ot">&lt;-</span> <span class="fu">get_post_stats</span>(post_params1)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>school2_result <span class="ot">&lt;-</span> <span class="fu">get_post_stats</span>(post_params2)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>school3_result <span class="ot">&lt;-</span> <span class="fu">get_post_stats</span>(post_params3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the results</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the data frame</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">School =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"School1"</span>, <span class="st">"School2"</span>, <span class="st">"School3"</span>), <span class="at">each=</span><span class="dv">2</span>),</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Parameter =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"θ"</span>, <span class="st">"σ"</span>), <span class="at">times=</span><span class="dv">3</span>),</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Posterior_Mean =</span> <span class="fu">c</span>(school1_result<span class="sc">$</span>mean_theta, school1_result<span class="sc">$</span>mean_sigma, school2_result<span class="sc">$</span>mean_theta, school2_result<span class="sc">$</span>mean_sigma, school3_result<span class="sc">$</span>mean_theta, school3_result<span class="sc">$</span>mean_sigma),</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Lower_CI =</span> <span class="fu">c</span>(school1_result<span class="sc">$</span>CI_theta[<span class="dv">1</span>], school1_result<span class="sc">$</span>CI_sigma[<span class="dv">1</span>], school2_result<span class="sc">$</span>CI_theta[<span class="dv">1</span>], school2_result<span class="sc">$</span>CI_sigma[<span class="dv">1</span>], school3_result<span class="sc">$</span>CI_theta[<span class="dv">1</span>], school3_result<span class="sc">$</span>CI_sigma[<span class="dv">1</span>]),</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Upper_CI =</span> <span class="fu">c</span>(school1_result<span class="sc">$</span>CI_theta[<span class="dv">2</span>], school1_result<span class="sc">$</span>CI_sigma[<span class="dv">2</span>], school2_result<span class="sc">$</span>CI_theta[<span class="dv">2</span>], school2_result<span class="sc">$</span>CI_sigma[<span class="dv">2</span>], school3_result<span class="sc">$</span>CI_theta[<span class="dv">2</span>], school3_result<span class="sc">$</span>CI_sigma[<span class="dv">2</span>])</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the table</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(results, <span class="at">caption =</span> <span class="st">"Posterior means and 95% confidence intervals"</span>, <span class="at">align =</span> <span class="st">'c'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Posterior means and 95% confidence intervals</caption>
<thead>
<tr class="header">
<th style="text-align: center;">School</th>
<th style="text-align: center;">Parameter</th>
<th style="text-align: center;">Posterior_Mean</th>
<th style="text-align: center;">Lower_CI</th>
<th style="text-align: center;">Upper_CI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">School1</td>
<td style="text-align: center;">θ</td>
<td style="text-align: center;">9.294259</td>
<td style="text-align: center;">7.751515</td>
<td style="text-align: center;">10.821329</td>
</tr>
<tr class="even">
<td style="text-align: center;">School1</td>
<td style="text-align: center;">σ</td>
<td style="text-align: center;">3.913679</td>
<td style="text-align: center;">3.004643</td>
<td style="text-align: center;">5.151806</td>
</tr>
<tr class="odd">
<td style="text-align: center;">School2</td>
<td style="text-align: center;">θ</td>
<td style="text-align: center;">6.934470</td>
<td style="text-align: center;">5.158662</td>
<td style="text-align: center;">8.711536</td>
</tr>
<tr class="even">
<td style="text-align: center;">School2</td>
<td style="text-align: center;">σ</td>
<td style="text-align: center;">4.401337</td>
<td style="text-align: center;">3.355815</td>
<td style="text-align: center;">5.887871</td>
</tr>
<tr class="odd">
<td style="text-align: center;">School3</td>
<td style="text-align: center;">θ</td>
<td style="text-align: center;">7.824313</td>
<td style="text-align: center;">6.216848</td>
<td style="text-align: center;">9.500930</td>
</tr>
<tr class="even">
<td style="text-align: center;">School3</td>
<td style="text-align: center;">σ</td>
<td style="text-align: center;">3.753878</td>
<td style="text-align: center;">2.799570</td>
<td style="text-align: center;">5.115452</td>
</tr>
</tbody>
</table>
</div>
</div>
<ol start="2" type="a">
<li>The posterior probability that θi &lt; θj &lt; θk for all six permutations {i, j, k} of {1, 2, 3}</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>get_theta <span class="ot">&lt;-</span> <span class="cf">function</span>(post_params){</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  s2_sampling <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">rgamma</span>(<span class="dv">10000</span>,<span class="at">shape =</span> post_params<span class="sc">$</span>nu_n <span class="sc">/</span> <span class="dv">2</span>, <span class="at">rate =</span> post_params<span class="sc">$</span>sigma2_n <span class="sc">*</span> (post_params<span class="sc">$</span>nu_n <span class="sc">/</span> <span class="dv">2</span>))</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  theta_sampling <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>, <span class="at">mean =</span> post_params<span class="sc">$</span>mu_n, <span class="at">sd =</span> <span class="fu">sqrt</span>(s2_sampling<span class="sc">/</span>post_params<span class="sc">$</span>kappa_n))</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(theta_sampling)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>theta1_sims <span class="ot">&lt;-</span> <span class="fu">get_theta</span>(post_params1)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>theta2_sims <span class="ot">&lt;-</span> <span class="fu">get_theta</span>(post_params2)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>theta3_sims <span class="ot">&lt;-</span> <span class="fu">get_theta</span>(post_params3)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>prob_theta_123 <span class="ot">&lt;-</span> <span class="fu">mean</span>(theta1_sims <span class="sc">&lt;</span> theta2_sims <span class="sc">&amp;</span> theta2_sims <span class="sc">&lt;</span> theta3_sims)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>prob_theta_132 <span class="ot">&lt;-</span> <span class="fu">mean</span>(theta1_sims <span class="sc">&lt;</span> theta3_sims <span class="sc">&amp;</span> theta3_sims <span class="sc">&lt;</span> theta2_sims)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>prob_theta_213 <span class="ot">&lt;-</span> <span class="fu">mean</span>(theta2_sims <span class="sc">&lt;</span> theta1_sims <span class="sc">&amp;</span> theta1_sims <span class="sc">&lt;</span> theta3_sims)</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>prob_theta_231 <span class="ot">&lt;-</span> <span class="fu">mean</span>(theta2_sims <span class="sc">&lt;</span> theta3_sims <span class="sc">&amp;</span> theta3_sims <span class="sc">&lt;</span> theta1_sims)</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>prob_theta_321 <span class="ot">&lt;-</span> <span class="fu">mean</span>(theta3_sims <span class="sc">&lt;</span> theta2_sims <span class="sc">&amp;</span> theta2_sims <span class="sc">&lt;</span> theta1_sims)</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>prob_theta_312 <span class="ot">&lt;-</span> <span class="fu">mean</span>(theta3_sims <span class="sc">&lt;</span> theta1_sims <span class="sc">&amp;</span> theta1_sims <span class="sc">&lt;</span> theta2_sims)</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"P(θ1 &lt; θ2 &lt; θ3) = "</span>, prob_theta_123, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>P(θ1 &lt; θ2 &lt; θ3) =  0.0057 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"P(θ1 &lt; θ3 &lt; θ2) = "</span>, prob_theta_132, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>P(θ1 &lt; θ3 &lt; θ2) =  0.0041 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"P(θ2 &lt; θ1 &lt; θ3) = "</span>, prob_theta_213, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>P(θ2 &lt; θ1 &lt; θ3) =  0.0895 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"P(θ2 &lt; θ3 &lt; θ1) = "</span>, prob_theta_231, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>P(θ2 &lt; θ3 &lt; θ1) =  0.6696 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"P(θ3 &lt; θ2 &lt; θ1) = "</span>, prob_theta_321, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>P(θ3 &lt; θ2 &lt; θ1) =  0.2141 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"P(θ3 &lt; θ1 &lt; θ2) = "</span>, prob_theta_312, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>P(θ3 &lt; θ1 &lt; θ2) =  0.017 </code></pre>
</div>
</div>
<ol start="3" type="a">
<li>The posterior probability that Y˜i &lt; Y˜j &lt; Y˜k for all six permutations {i, j, k} of {1, 2, 3}, where Y˜i is a sample from the posterior predictive distribution of school i for i = 1, 2, 3.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>get_y_pred <span class="ot">&lt;-</span> <span class="cf">function</span>(post_params){</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  s2_sampling <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">rgamma</span>(<span class="dv">10000</span>,<span class="at">shape =</span> post_params<span class="sc">$</span>nu_n <span class="sc">/</span> <span class="dv">2</span>, <span class="at">rate =</span> post_params<span class="sc">$</span>sigma2_n <span class="sc">*</span> (post_params<span class="sc">$</span>nu_n <span class="sc">/</span> <span class="dv">2</span>))</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  theta_sampling <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>, <span class="at">mean =</span> post_params<span class="sc">$</span>mu_n, <span class="at">sd =</span> <span class="fu">sqrt</span>(s2_sampling<span class="sc">/</span>post_params<span class="sc">$</span>kappa_n))</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  y_pred <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>, <span class="at">mean =</span> theta_sampling, <span class="at">sd =</span> <span class="fu">sqrt</span>(s2_sampling))</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(y_pred)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>y1_tilde <span class="ot">&lt;-</span> <span class="fu">get_y_pred</span>(post_params1)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>y2_tilde <span class="ot">&lt;-</span> <span class="fu">get_y_pred</span>(post_params2)</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>y3_tilde <span class="ot">&lt;-</span> <span class="fu">get_y_pred</span>(post_params3)</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>y_tilde_123 <span class="ot">&lt;-</span> <span class="fu">mean</span>(y1_tilde <span class="sc">&lt;</span> y2_tilde <span class="sc">&amp;</span> y2_tilde <span class="sc">&lt;</span> y3_tilde)</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>y_tilde_132 <span class="ot">&lt;-</span> <span class="fu">mean</span>(y1_tilde <span class="sc">&lt;</span> y3_tilde <span class="sc">&amp;</span> y3_tilde <span class="sc">&lt;</span> y2_tilde)</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>y_tilde_213 <span class="ot">&lt;-</span> <span class="fu">mean</span>(y2_tilde <span class="sc">&lt;</span> y1_tilde <span class="sc">&amp;</span> y1_tilde <span class="sc">&lt;</span> y3_tilde)</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>y_tilde_231 <span class="ot">&lt;-</span> <span class="fu">mean</span>(y2_tilde <span class="sc">&lt;</span> y3_tilde <span class="sc">&amp;</span> y3_tilde <span class="sc">&lt;</span> y1_tilde)</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>y_tilde_312 <span class="ot">&lt;-</span> <span class="fu">mean</span>(y3_tilde <span class="sc">&lt;</span> y1_tilde <span class="sc">&amp;</span> y1_tilde <span class="sc">&lt;</span> y2_tilde)</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>y_tilde_321 <span class="ot">&lt;-</span> <span class="fu">mean</span>(y3_tilde <span class="sc">&lt;</span> y2_tilde <span class="sc">&amp;</span> y2_tilde <span class="sc">&lt;</span> y1_tilde)</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"P(Y1 &lt; Y2 &lt; Y3) = "</span>, y_tilde_123, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>P(Y1 &lt; Y2 &lt; Y3) =  0.1084 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"P(Y1 &lt; Y3 &lt; Y2) = "</span>, y_tilde_132, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>P(Y1 &lt; Y3 &lt; Y2) =  0.1051 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"P(Y2 &lt; Y1 &lt; Y3) = "</span>, y_tilde_213, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>P(Y2 &lt; Y1 &lt; Y3) =  0.1785 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"P(Y2 &lt; Y3 &lt; Y1) = "</span>, y_tilde_231, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>P(Y2 &lt; Y3 &lt; Y1) =  0.2667 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"P(Y3 &lt; Y2 &lt; Y1) = "</span>, y_tilde_321, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>P(Y3 &lt; Y2 &lt; Y1) =  0.2059 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"P(Y3 &lt; Y1 &lt; Y2) = "</span>, y_tilde_312, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>P(Y3 &lt; Y1 &lt; Y2) =  0.1354 </code></pre>
</div>
</div>
<ol start="4" type="a">
<li>Compute the posterior probability that θ1 &gt; max{θ2, θ3} and the posterior probability that Y˜1 &gt; max{Y˜2, Y˜3}.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>theta1_sims <span class="ot">&lt;-</span> <span class="fu">get_theta</span>(post_params1)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>theta2_sims <span class="ot">&lt;-</span> <span class="fu">get_theta</span>(post_params2)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>theta3_sims <span class="ot">&lt;-</span> <span class="fu">get_theta</span>(post_params3)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="co"># For θ</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>prob_theta1_max <span class="ot">=</span> <span class="fu">mean</span>(theta1_sims <span class="sc">&gt;</span> <span class="fu">pmax</span>(theta2_sims, theta3_sims))</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>y1_tilde <span class="ot">&lt;-</span> <span class="fu">get_y_pred</span>(post_params1)</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>y2_tilde <span class="ot">&lt;-</span> <span class="fu">get_y_pred</span>(post_params2)</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>y3_tilde <span class="ot">&lt;-</span> <span class="fu">get_y_pred</span>(post_params3)</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a><span class="co"># For Y_tilda</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>prob_ytilda1_max <span class="ot">=</span> <span class="fu">mean</span>(y1_tilde <span class="sc">&gt;</span> <span class="fu">pmax</span>(y2_tilde, y3_tilde))</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"P(θ1 &gt; max{θ2, θ3}): "</span>,prob_theta1_max,<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>P(θ1 &gt; max{θ2, θ3}):  0.8888 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"P(Y˜1 &gt; max{Y˜2, Y˜3}): "</span>,prob_ytilda1_max,<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>P(Y˜1 &gt; max{Y˜2, Y˜3}):  0.4714 </code></pre>
</div>
</div>
<p>ci_normal &lt;- function(params) { mu &lt;- params<span class="math inline">\(mu_n sigma &lt;- sqrt(params\)</span>sigma2_n / (params$kappa_n)) qnorm(c(0.025, 0.975), mean=mu, sd=sigma) }</p>
<p>ci_inv_gamma &lt;- function(params) { alpha &lt;- params<span class="math inline">\(nu_n / 2 beta &lt;- params\)</span>nu_n * params$sigma2_n / 2 qgamma(c(0.975, 0.025), shape=alpha, rate=beta) }</p>
<p>ci_theta1 &lt;- ci_normal(post_params1) cat(“95% CI for theta1:”,ci_theta1,‘’) ci_sigma1 &lt;- sqrt(ci_inv_gamma(post_params1)) cat(“95% CI for sigma1:”,ci_sigma1,‘’) ci_theta2 &lt;- ci_normal(post_params2) cat(“95% CI for theta2:”,ci_theta2,‘’) ci_sigma2 &lt;- sqrt(ci_inv_gamma(post_params2)) cat(“95% CI for sigma2:”,ci_sigma2,‘’) ci_theta3 &lt;- ci_normal(post_params3) cat(“95% CI for theta3:”,ci_theta3,‘’) ci_sigma3 &lt;- sqrt(ci_inv_gamma(post_params3)) cat(“95% CI for sigma3:”,ci_sigma3,‘’)</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>